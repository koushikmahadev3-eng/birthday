<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEBULA OS | Anniversary Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100;300;600;900&family=Syncopate:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* CSS ARCHITECTURE: 
           High-performance layout using Grid and Hardware Acceleration
        */
        :root {
            --accent: #00f3ff;
            --gold: #ffd700;
            --bg: #050505;
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-font-smoothing: antialiased;
        }

        body, html {
            width: 100%;
            height: 100%;
            background: var(--bg);
            color: #fff;
            font-family: 'Outfit', sans-serif;
            overflow: hidden;
        }

        /* Dual-Pane Layout */
        #master-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            width: 200vw; /* For mobile side-by-side or desktop split */
            height: 100vh;
            transition: transform 0.8s cubic-bezier(0.85, 0, 0.15, 1);
        }

        @media (min-width: 1024px) {
            #master-container {
                width: 100vw;
            }
        }

        /* Left Pane: Message Engine */
        #message-pane {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 10% 8%;
            background: linear-gradient(90deg, #000 0%, transparent 100%);
            z-index: 5;
            border-right: 1px solid var(--border);
            overflow-y: auto;
            scrollbar-width: none;
        }

        #message-pane::-webkit-scrollbar { display: none; }

        .tagline {
            font-family: 'Syncopate', sans-serif;
            font-size: 0.8rem;
            letter-spacing: 0.5em;
            color: var(--accent);
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        .main-title {
            font-size: clamp(3rem, 8vw, 6rem);
            font-weight: 900;
            line-height: 0.9;
            margin-bottom: 30px;
        }

        .scrolling-messages {
            margin-top: 50px;
        }

        .msg-card {
            background: var(--glass);
            border: 1px solid var(--border);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            opacity: 0;
            transform: translateX(-50px);
        }

        /* Right Pane: WebGL Engine */
        #canvas-pane {
            position: relative;
            height: 100vh;
            background: #000;
            overflow: hidden;
        }

        canvas {
            width: 100%;
            height: 100%;
            display: block;
            touch-action: none;
        }

        /* Interface Elements */
        #ui-overlay {
            position: fixed;
            bottom: 40px;
            right: 40px;
            display: flex;
            gap: 20px;
            z-index: 100;
        }

        .control-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 1px solid var(--border);
            background: var(--glass);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: 0.3s;
        }

        .control-btn:hover {
            border-color: var(--accent);
            background: rgba(0, 243, 255, 0.1);
        }

        /* Intro Screen */
        #boot-sequence {
            position: fixed;
            inset: 0;
            background: #000;
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .loader-bar {
            width: 200px;
            height: 2px;
            background: #222;
            margin-top: 20px;
            position: relative;
            overflow: hidden;
        }

        .loader-progress {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 0%;
            background: var(--accent);
        }
    </style>
</head>
<body>

    <div id="boot-sequence">
        <div style="font-family: 'Syncopate'; font-size: 10px; letter-spacing: 5px;">INITIALIZING KINETIC CORE</div>
        <div class="loader-bar">
            <div class="loader-progress" id="load-progress"></div>
        </div>
    </div>

    <div id="master-container">
        <section id="message-pane">
            <div class="tagline">Year 2026 Edition</div>
            <h1 class="main-title">HAPPY<br><span style="color: var(--gold)">BIRTHDAY</span></h1>
            
            <div class="scrolling-messages" id="msg-container">
                <div class="msg-card">
                    <h3>The Visionary</h3>
                    <p>May your creativity continue to reshape the world. You don't just follow the path; you build it.</p>
                </div>
                <div class="msg-card">
                    <h3>Absolute Excellence</h3>
                    <p>On your special day, we celebrate the drive and the logic that makes you a legend.</p>
                </div>
                <div class="msg-card">
                    <h3>God-Tier Spirit</h3>
                    <p>Keep pushing the boundaries of what is possible. The universe is your playground.</p>
                </div>
                <div class="msg-card">
                    <h3>Infinity Beyond</h3>
                    <p>Scroll deeper to unlock the hidden memories of this digital odyssey.</p>
                </div>
            </div>
        </section>

        <section id="canvas-pane">
            <canvas id="nebula-canvas"></canvas>
            
            <div style="position: absolute; top: 40px; left: 40px; pointer-events: none;">
                <div style="font-size: 10px; color: var(--accent); opacity: 0.6;">SYSTEM STATUS: OPTIMIZED</div>
                <div id="fps-counter" style="font-size: 24px; font-weight: 100;">60 FPS</div>
            </div>
        </section>
    </div>

    <div id="ui-overlay">
        <div class="control-btn" id="switch-view">↔</div>
        <div class="control-btn" id="reset-sim">↺</div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <script id="v-shader" type="x-shader/x-vertex">
        attribute vec2 position;
        varying vec2 vUv;
        void main() {
            vUv = position * 0.5 + 0.5;
            gl_Position = vec4(position, 0.0, 1.0);
        }
    </script>

    <script id="f-shader" type="x-shader/x-fragment">
        /* GOD-TIER FRAGMENT SHADER 
           Implements: Fractional Brownian Motion, Domain Warping, and Light Scattering
        */
        precision highp float;
        uniform float uTime;
        uniform vec2 uResolution;
        uniform vec2 uMouse;
        uniform float uMouseActive;
        varying vec2 vUv;

        // High frequency hashing for noise
        float hash(vec2 p) {
            p = fract(p * vec2(123.34, 456.21));
            p += dot(p, p + 45.32);
            return fract(p.x * p.y);
        }

        // 2D Noise function
        float noise(vec2 p) {
            vec2 i = floor(p);
            vec2 f = fract(p);
            float a = hash(i);
            float b = hash(i + vec2(1.0, 0.0));
            float c = hash(i + vec2(0.0, 1.0));
            float d = hash(i + vec2(1.0, 1.0));
            vec2 u = f * f * (3.0 - 2.0 * f);
            return mix(a, b, u.x) + (c - a) * u.y * (1.0 - u.x) + (d - b) * u.x * u.y;
        }

        // Fractional Brownian Motion (Complex layers)
        float fbm(vec2 p) {
            float v = 0.0;
            float a = 0.5;
            vec2 shift = vec2(100.0);
            mat2 rot = mat2(cos(0.5), sin(0.5), -sin(0.5), cos(0.5));
            for (int i = 0; i < 8; ++i) {
                v += a * noise(p);
                p = rot * p * 2.0 + shift;
                a *= 0.5;
            }
            return v;
        }

        void main() {
            vec2 uv = gl_FragCoord.xy / uResolution.xy;
            vec2 p = (gl_FragCoord.xy * 2.0 - uResolution.xy) / min(uResolution.x, uResolution.y);
            
            // Domain Warping (The Secret to God-Tier fluid look)
            vec2 q = vec2(
                fbm(p + vec2(0.0, 0.0)),
                fbm(p + vec2(5.2, 1.3))
            );
            
            vec2 r = vec2(
                fbm(p + 4.0 * q + vec2(1.7, 9.2) + 0.15 * uTime),
                fbm(p + 4.0 * q + vec2(8.3, 2.8) + 0.126 * uTime)
            );

            float f = fbm(p + 4.0 * r);

            // Interaction logic
            float dist = length(p - (uMouse * 2.0 - 1.0) * vec2(uResolution.x/uResolution.y, 1.0));
            float mouseInfluence = smoothstep(0.4, 0.0, dist) * uMouseActive;

            // Coloring logic
            vec3 color = mix(
                vec3(0.02, 0.01, 0.05), // Deep space
                vec3(0.0, 0.6, 1.0),    // Electric cyan
                clamp((f * f) * 4.0, 0.0, 1.0)
            );

            color = mix(
                color,
                vec3(1.0, 0.84, 0.0),   // Birthday Gold
                clamp(length(q), 0.0, 1.0) * 0.4
            );

            color = mix(
                color,
                vec3(1.0, 1.0, 1.0),
                clamp(length(r.x), 0.0, 1.0) * 0.1
            );

            // Final intensity polish
            float intensity = f * f * f * 1.5 + 0.2 * f * f + 0.5 * f;
            intensity += mouseInfluence * 0.5;
            
            gl_FragColor = vec4(color * intensity, 1.0);
        }
    </script>

    <script>
        /**
         * LOGIC CORE
         * This script manages the state, the WebGL lifecycle, and the dual-pane transitions.
         */
        const CONFIG = {
            particleCount: 5000,
            simSpeed: 0.005,
            glowIntensity: 1.5,
            dualPane: true
        };

        class NebulaEngine {
            constructor(canvasId) {
                this.canvas = document.getElementById(canvasId);
                this.gl = this.canvas.getContext('webgl');
                this.startTime = Date.now();
                this.mouse = { x: 0.5, y: 0.5, active: 0 };
                this.fpsData = {
                    lastTime: 0,
                    frames: 0
                };
                
                if (!this.gl) {
                    alert('WebGL not supported on this device');
                    return;
                }

                this.init();
            }

            init() {
                this.createProgram();
                this.createBuffers();
                this.setupEvents();
                this.resize();
                this.animate();
            }

            createProgram() {
                const vs = this.compileShader(this.gl.VERTEX_SHADER, document.getElementById('v-shader').text);
                const fs = this.compileShader(this.gl.FRAGMENT_SHADER, document.getElementById('f-shader').text);
                
                this.program = this.gl.createProgram();
                this.gl.attachShader(this.program, vs);
                this.gl.attachShader(this.program, fs);
                this.gl.linkProgram(this.program);
                this.gl.useProgram(this.program);
            }

            compileShader(type, source) {
                const shader = this.gl.createShader(type);
                this.gl.shaderSource(shader, source);
                this.gl.compileShader(shader);
                if (!this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS)) {
                    console.error(this.gl.getShaderInfoLog(shader));
                    this.gl.deleteShader(shader);
                    return null;
                }
                return shader;
            }

            createBuffers() {
                this.buffer = this.gl.createBuffer();
                this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.buffer);
                this.gl.bufferData(this.gl.ARRAY_BUFFER, new Float32Array([
                    -1.0, -1.0, 1.0, -1.0, -1.0, 1.0,
                    -1.0, 1.0, 1.0, -1.0, 1.0, 1.0
                ]), this.gl.STATIC_DRAW);

                const posLoc = this.gl.getAttribLocation(this.program, 'position');
                this.gl.enableVertexAttribArray(posLoc);
                this.gl.vertexAttribPointer(posLoc, 2, this.gl.FLOAT, false, 0, 0);
            }

            setupEvents() {
                const handlePointer = (e) => {
                    const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                    const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                    
                    // Normalize mouse to the canvas-pane area
                    const rect = this.canvas.getBoundingClientRect();
                    this.mouse.x = (clientX - rect.left) / rect.width;
                    this.mouse.y = 1.0 - (clientY - rect.top) / rect.height;
                    this.mouse.active = 1.0;
                };

                window.addEventListener('mousemove', handlePointer);
                window.addEventListener('touchstart', handlePointer);
                window.addEventListener('touchend', () => {
                    gsap.to(this.mouse, { active: 0, duration: 2 });
                });
            }

            resize() {
                const dpr = Math.min(window.devicePixelRatio, 2); // Limit for perf
                this.canvas.width = this.canvas.clientWidth * dpr;
                this.canvas.height = this.canvas.clientHeight * dpr;
                this.gl.viewport(0, 0, this.canvas.width, this.canvas.height);
            }

            updateFPS() {
                const now = performance.now();
                this.fpsData.frames++;
                if (now > this.fpsData.lastTime + 1000) {
                    const fps = Math.round((this.fpsData.frames * 1000) / (now - this.fpsData.lastTime));
                    document.getElementById('fps-counter').innerText = `${fps} FPS`;
                    this.fpsData.lastTime = now;
                    this.fpsData.frames = 0;
                }
            }

            animate() {
                this.updateFPS();
                const time = (Date.now() - this.startTime) * 0.001;
                
                this.gl.uniform1f(this.gl.getUniformLocation(this.program, 'uTime'), time);
                this.gl.uniform2f(this.gl.getUniformLocation(this.program, 'uResolution'), this.canvas.width, this.canvas.height);
                this.gl.uniform2f(this.gl.getUniformLocation(this.program, 'uMouse'), this.mouse.x, this.mouse.y);
                this.gl.uniform1f(this.gl.getUniformLocation(this.program, 'uMouseActive'), this.mouse.active);

                this.gl.drawArrays(this.gl.TRIANGLES, 0, 6);
                requestAnimationFrame(() => this.animate());
            }
        }

        // Initialize Everything
        window.onload = () => {
            const engine = new NebulaEngine('nebula-canvas');
            
            // Boot Animation Sequence
            const tl = gsap.timeline();
            tl.to("#load-progress", { width: "100%", duration: 2, ease: "power2.inOut" })
              .to("#boot-sequence", { y: "-100%", duration: 1, ease: "expo.inOut" })
              .to(".msg-card", { 
                  opacity: 1, 
                  x: 0, 
                  stagger: 0.2, 
                  duration: 1, 
                  ease: "back.out(1.7)" 
              }, "-=0.5");

            // View Switcher (Mobile Logic)
            let isPaneView = false;
            document.getElementById('switch-view').onclick = () => {
                const container = document.getElementById('master-container');
                isPaneView = !isPaneView;
                container.style.transform = isPaneView ? "translateX(-100vw)" : "translateX(0)";
            };

            // Resize observer for the canvas
            window.addEventListener('resize', () => engine.resize());
        };
    </script>
</body>
</html>
